import java.security.KeyPair; 
import java.security.KeyPairGenerator; 
import java.security.PrivateKey; 
import java.security.PublicKey; 
import java.security.SecureRandom;
import javax.crypto.Cipher; 
public class RSAExample { 
public static void main(String[] args) { 
try { 

KeyPairGenerator keyGen = 
KeyPairGenerator.getInstance("RSA"); 
            keyGen.initialize(2048, new SecureRandom());
            KeyPair keyPair = keyGen.generateKeyPair(); 
 
            PublicKey publicKey = keyPair.getPublic(); 
            PrivateKey privateKey = keyPair.getPrivate(); 
 
            System.out.println("Public Key: " + publicKey); 
            System.out.println("Private Key: " + privateKey); 

            String message = "Hello, RSA Encryption!"; 
            System.out.println("\nOriginal Message: " + message); 

            Cipher encryptCipher = Cipher.getInstance("RSA"); 
            encryptCipher.init(Cipher.ENCRYPT_MODE, publicKey); 
            byte[] encryptedBytes = 
encryptCipher.doFinal(message.getBytes()); 
            System.out.println("Encrypted Message (bytes): " + 
bytesToHex(encryptedBytes)); 

            Cipher decryptCipher = Cipher.getInstance("RSA"); 
            decryptCipher.init(Cipher.DECRYPT_MODE, privateKey); 
            byte[] decryptedBytes = decryptCipher.doFinal(encryptedBytes); 
            String decryptedMessage = new String(decryptedBytes); 
 
            System.out.println("Decrypted Message: " + decryptedMessage); 
 
        } catch (Exception e) { 
            e.printStackTrace(); 
        } 
    } 

    private static String bytesToHex(byte[] bytes) { 
        StringBuilder sb = new StringBuilder(); 
        for (byte b : bytes) { 
            sb.append(String.format("%02X", b)); 
        } 
        return sb.toString(); 
    } 
}
